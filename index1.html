<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Game L·∫≠t H√¨nh T√¨nh Y√™u</title>
    <style>
      body {
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #fff;
        font-family: Arial, sans-serif;
        margin: 0;
      }

      .marquee {
        width: 100%;
        overflow: hidden;
        white-space: nowrap;
        box-sizing: border-box;
        border: 2px solid pink;
        background: #ffe6f2;
        height: 60px;
        display: flex;
        align-items: center;
      }

      .marquee span {
        display: inline-block;
        padding-left: 100%;
        animation: scroll 10s linear infinite;
        font-size: 24px;
        color: red;
        font-weight: bold;
      }

      @keyframes scroll {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(-100%);
        }
      }

      .container {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin: 40px auto;
        padding: 0 20px;
        max-width: 800px;
      }

      .box {
        background: pink;
        border-radius: 10px;
        height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        position: relative;
        perspective: 1000px;
      }

      .card {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.6s;
      }

      .card.flipped {
        transform: rotateY(180deg);
      }

      .front,
      .back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 10px;
      }

      .front {
        background: #ff99cc;
      }

      .back {
        transform: rotateY(180deg);
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
      }

      .back img {
        max-width: 100%;
        max-height: 100%;
        border-radius: 10px;
      }

      /* ‚ù§Ô∏è Hi·ªáu ·ª©ng tr√°i tim */
      .heart {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-size: 100px;
        color: red;
        opacity: 0;
        transition: all 0.5s ease;
        pointer-events: none;
        z-index: 9999;
      }

      .heart.show {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <audio id="bg-music" loop>
      <source
        src="audio/Chocobo Racing - Cid's Test Course.mp3"
        type="audio/mpeg"
      />
      Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ph√°t nh·∫°c.
    </audio>
    <div class="marquee">
      <span>‚ù§Ô∏è D√†nh cho V∆∞∆°ng Th·∫£o ‚ù§Ô∏è</span>
    </div>

    <div class="container" id="game-board"></div>

    <!-- Tr√°i tim hi·ªán ·ªü gi·ªØa m√†n h√¨nh -->
    <div class="heart" id="heart" style="text-align: center; width: 100%">
      ‚ù§Ô∏è Gi·ªèi qu√© Th·∫ªo uiii
    </div>

    <div
      id="final-heart"
      style="
        display: none;
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 50px;
        color: red;
        text-align: center;
      "
    >
      üéâ‚ù§Ô∏è Ch√∫c m·ª´ng t·ª•c d√†ngggggg ‚ù§Ô∏èüéâ
    </div>
    <script>
      const bgMusic = document.getElementById("bg-music");

      window.addEventListener("DOMContentLoaded", () => {
        if (localStorage.getItem("playMusic") === "true") {
          bgMusic.play().catch(() => {
            console.log("Tr√¨nh duy·ªát ch·∫∑n autoplay, c·∫ßn user click.");
          });
          localStorage.removeItem("playMusic"); // xo√° ƒëi cho l·∫ßn sau
        }
      });

      // ph√°t nh·∫°c khi ng∆∞·ªùi ch∆°i click l·∫ßn ƒë·∫ßu
      document.body.addEventListener(
        "click",
        () => {
          bgMusic.play().catch(() => {
            console.log("Tr√¨nh duy·ªát ch·∫∑n autoplay, c·∫ßn ng∆∞·ªùi d√πng b·∫•m.");
          });
        },
        { once: true }
      ); // ch·ªâ ch·∫°y 1 l·∫ßn
      const images = ["1.jpg", "2.jpg", "3.jpg", "4.jpg", "5.jpg", "6.jpg"];

      let cards = [...images, ...images];
      cards.sort(() => Math.random() - 0.5);

      const board = document.getElementById("game-board");
      const heart = document.getElementById("heart");
      let firstCard = null;
      let lockBoard = false;

      cards.forEach((imgSrc) => {
        const box = document.createElement("div");
        box.classList.add("box");

        box.innerHTML = `
        <div class="card" data-img="${imgSrc}">
          <div class="front"></div>
          <div class="back">
            <img src='images/${imgSrc}' style="width: auto; height: 100%" />
          </div>
        </div>
      `;

        board.appendChild(box);

        box.addEventListener("click", () => {
          if (lockBoard) return;
          const card = box.querySelector(".card");
          if (card.classList.contains("flipped")) return;

          card.classList.add("flipped");

          if (!firstCard) {
            firstCard = card;
          } else {
            const secondCard = card;
            if (firstCard.dataset.img === secondCard.dataset.img) {
              // ‚úÖ Gi·ªëng nhau -> hi·ªán tr√°i tim
              showHeart();
              firstCard = null;

              // üîπ Ki·ªÉm tra xem ƒë√£ l·∫≠t h·∫øt ch∆∞a
              const allFlipped =
                document.querySelectorAll(".card.flipped").length;
              const totalCards = document.querySelectorAll(".card").length;
              if (allFlipped === totalCards) {
                document.getElementById("final-heart").style.display = "block";
                localStorage.setItem("finalMusic", "true"); // b√°o cho trang sau bi·∫øt

                setTimeout(() => {
                  window.location.href = "finalLove.html"; // ƒë·ªïi t√™n file b·∫°n mu·ªën
                }, 2000);
              }
            } else {
              // ‚ùå Kh√¥ng gi·ªëng -> l·∫≠t l·∫°i
              lockBoard = true;
              setTimeout(() => {
                firstCard.classList.remove("flipped");
                secondCard.classList.remove("flipped");
                firstCard = null;
                lockBoard = false;
              }, 1000);
            }
          }
        });
      });

      const messages = [
        "‚ù§Ô∏è Gi·ªèi qu√© Th·∫ªo uiii",
        "üòç ƒê·ªânh lu√¥n c·ª•c d√†ng ∆°i",
        "üòò Y√™u em nh√¨u nh·∫Øm",
        "Moahhhhhhhhhhhhhhh",
        "üíñ N·∫Øc +1 :)))",
      ];

      function showHeart() {
        // ch·ªçn ng·∫´u nhi√™n 1 c√¢u
        const randomMsg = messages[Math.floor(Math.random() * messages.length)];
        heart.innerHTML = randomMsg; // thay ƒë·ªïi n·ªôi dung trong div

        heart.classList.add("show");
        setTimeout(() => {
          heart.classList.remove("show");
        }, 1000);
      }
    </script>
  </body>
</html>
